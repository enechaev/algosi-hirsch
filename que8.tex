\let\bf\bfseries
\let\it\itshape
\section{(WIP)Алгоритм Эдмондса-Карпа (\groth)}\label{edmonds_karp}
Вариант реализации алгоритма Форда-Фалкерсона, где в качестве алгоритма поиска пути используется поиск в ширину (предполагается, что у всех ребер единичная длина), называется {\bf\it алгоритмом Эдмондса-Карпа}. Для него есть хорошая оценка времени работы $O(|V||E|^2)$. Она хорошая, потому что не зависит от величины максимального потока.

Обозначим как $\delta_f(u,v)$ кратчайшее расстояние между вершинами $u$ и $v$ в остаточной сети $G_f$.
\begin{lemma}\label{someshit5}
	Для всех вершин $v\in V\smallsetminus\{s,t\}$ длина кратчайшего пути $\delta_f(s,v)$ в остаточной сети $G_f$ монотонно возрастает при выполнении алгоритма.
\end{lemma}
\begin{proof}
	Будем доказывать от обратного. Предположим, что существует такое увеличение потока, которое приводит к уменьшению длины кратчайшего пути из $s$ к некоторой вершине $v$. $f$~-- поток перед этим увеличением по пути, $f'$~-- поток после этого увеличения. Выберем $v$, чтобы $\delta_{f'}(s,v)$ было минимальным. Тогда $\delta_{f'}(s,v)<\delta_f(s,v)$. Пусть $u$~-- вершина перед $v$ в этом пути в $G_{f'}$, то есть $\delta_{f'}(s,u)=\delta_{f'}(s,v)-1$. По выбору $v$ $\delta_{f'}(s,u)\ge\delta_f(s,u)$ (иначе противоречие с минимальностью). 
	
	Теперь предположим, что $(u,v)\in E_f$. Но тогда $$\delta_{f'}(s,v)=\delta_{f'}(s,u)+1\ge\delta_f(s,u)+1=\delta_f(u,v)$$
	Теперь рассмотрим случай, когда $(u,v)\not\in E_f$ (но $(u,v)\in E_{f'}$). Заметим, что такое может произойти только в том случае, когда поток на ребре $f'(u,v)<f(u,v)$ ($c_{f'}(u,v)>0>c_f(u,v)$), а значит, поток на ребре $(v,u)$ увеличился. Алгоритм увеличивает поток только вдоль кратчайших путей, а это значит, что в $G_f$ кратчайший путь $s\to u$ содержит ребро $(v,u)$. Поэтому $$\delta_f(s,v)=\delta_f(s,u)-1\le\delta_{f'}(s,u)-1=\delta_{f'}(s,v)-1-1$$
	Опять получили противоречие с условием $\delta_{f'}(s,v)<\delta_f(s,v)$.
\end{proof}

Теперь мы можем посчитать ограничение на количество итераций основного цикла (того, в котором проводятся увеличения пути) алгоритма.

\begin{definition}
	{\bf\it Критическим} назовем ребро $(u,v)$ в пути $p$, для которого выполняется $c_f(u,v)=c_f(p)$ (ребро с наименьшей пропускной способностью из леммы~\ref{someshit2}).
\end{definition}
\begin{lemma}
	Количество итераций основного цикла~-- $O(|V||E|)$.
\end{lemma}
\begin{proof}
	Понятно, что в каждом увеличивающем пути есть критическое ребро, поэтому нам нужно посчитать, сколько раз каждое ребро может побывать критическим. 
	Докажем, что не больше $\frac{|V|}{2}-1$ раз.
	
	Пусть $(u,v)\in E$~-- критическое ребро. Так как увеличение проходит по кратчайшему пути, $\delta_f(s,v)=\delta_f(s,u)+1$. После этого это ребро пропадет из остаточной сети и появится обратно, только если $(v,u)$ появится в увеличивающем пути. Если $f'$~-- это такой новый поток, то $\delta_{f'}(s,u)=\delta_{f'}(s,v)+1$. По лемме~\ref{someshit5}, $\delta_f(s,v)\le\delta_{f'}(s,v)$, а значит
	$$
	\delta_{f'}(s,u)=\delta_{f'}(s,v)+1\ge\delta_f(s,v)+1=\delta_f(s,u)+2
	$$
	Так что  между случаями, когда ребро становится критическим, расстояние от источника вырастает как минимум на 2. Промежуточными вершинами на пути от $s$ к $u$ не могут быть $s$, $u$, и $t$. А это значит, что пока вершина $u$ станет недостижимой из источника, расстояние до нее не превысит $|V|-2$. Поэтому ребро $(u,v)$ станет критическим не более $\frac{|V|-2}{2}$ раз (делим на 2, потому что половину случаев ребро $(v,u)$ становится критическим). Так как всего ребер в остаточной сети может быть $O(|E|)$ (обоснование есть на странице~\pageref{someshit6}), количество критических ребер будет $O(|E||V|)$.
	
	Так как внутренность цикла выполняется за время $O(|E|)$, то общее время работы алгортма Эдмондса-Карпа~--- $O(|V||E|^2)$.
\end{proof}